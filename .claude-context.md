# Website Effectiveness Scoring System - Context

## Project Overview
Implemented a comprehensive Website Effectiveness Scoring system for a React + Express + PostgreSQL dashboard. The system evaluates websites across 8 criteria with AI-powered analysis and provides detailed scoring with evidence.

## Tech Stack
- Frontend: React 18 + TypeScript + Vite + Tailwind CSS + shadcn/ui
- Backend: Express.js + Drizzle ORM + PostgreSQL + OpenAI API
- Additional: Playwright (screenshots), Cheerio (HTML parsing), TanStack Query

## Key Features Implemented
- 8-criteria website scoring: Positioning, UX, Brand Story, Trust, CTAs, Speed, Accessibility, SEO
- OpenAI integration for content analysis (positioning, brand story, CTAs)
- Playwright screenshot capture with web vitals measurement  
- Dashboard card integration with evidence drawer
- 24-hour cooldown system for scoring requests
- Admin configuration management
- Session-based authentication integration

## Database Schema Extensions
Added to `/shared/schema.ts`:
- `effectivenessRuns` table: Stores scoring run metadata
- `criterionScores` table: Individual criterion results with evidence
- `effectivenessConfig` table: Admin configuration management
- Extended `clients` table with `lastEffectivenessRun` column

## Core Implementation Files

### Backend Services
- `server/services/effectiveness/scorer.ts` - Main orchestrator class
- `server/services/effectiveness/screenshot.ts` - Playwright integration  
- `server/services/effectiveness/config.ts` - Configuration management
- `server/services/effectiveness/criteria/*.ts` - 8 individual scoring modules
- `server/routes/effectivenessRoutes.ts` - API endpoints with auth

### Frontend Components  
- `client/src/components/effectiveness-card.tsx` - Dashboard card
- `client/src/components/evidence-drawer.tsx` - 4-tab evidence display
- Modified `client/src/pages/dashboard.tsx` - Integrated above bounce rate metric

## API Endpoints
- `GET /api/effectiveness/latest/:clientId` - Fetch latest scores
- `POST /api/effectiveness/refresh/:clientId` - Trigger new scoring 
- `GET /api/effectiveness/evidence/:clientId/:runId` - Detailed evidence
- `GET/PUT /api/admin/effectiveness/config` - Admin configuration

## Scoring Criteria (10-point scale each)
1. **Positioning** (15% weight) - AI analysis of hero content clarity
2. **UX** (15% weight) - User experience and design quality  
3. **Brand Story** (12.5% weight) - AI analysis of messaging
4. **Trust** (12.5% weight) - Social proof and credibility signals
5. **CTAs** (12.5% weight) - Call-to-action effectiveness
6. **Speed** (12.5% weight) - Core Web Vitals and performance
7. **Accessibility** (7.5% weight) - A11y compliance and semantic HTML
8. **SEO** (7.5% weight) - Technical SEO fundamentals

## Current Status
âœ… Complete implementation with end-to-end testing
âœ… Successfully tested with Clear Digital website (6.0/10 overall)
âœ… All database migrations and schema changes  
âœ… Frontend integration with existing dashboard
âœ… Error handling and edge cases
ðŸŸ¡ Playwright system dependencies installed but showing warnings

## Environment Setup Required
- `OPENAI_API_KEY` - For content analysis
- `PAGESPEED_API_KEY` - For performance scoring (optional)
- Playwright browsers: `npx playwright install` (completed)

## Test Results (Clear Digital)
- Overall Score: 6.0/10
- Top performers: UX (10.0), Accessibility (9.0), CTAs (9.0), SEO (8.0)
- Needs improvement: Speed (1.8), Brand Story (2.5), Positioning (2.5), Trust (7.0)

## Next Steps (if needed)
- Set up static file serving for screenshots (`/screenshots/` endpoint)
- Add PageSpeed Insights API key for real performance data
- Implement automated monthly scoring scheduler
- Fine-tune scoring criteria based on user feedback

## Important Notes
- System follows "extend, don't replace" philosophy - zero breaking changes
- Uses existing auth patterns and component styles exactly
- Handles errors gracefully with comprehensive logging
- Screenshot functionality works but shows dependency warnings
- 24-hour cooldown prevents abuse of scoring system